<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 ISC ëŒ€ë§Œ ì—¬í–‰</title>

  <!-- ë°˜ì‘í˜• CSS -->
  <link rel="stylesheet" href="css/desktop.css" media="(min-width: 768px)">
  <link rel="stylesheet" href="css/mobile.css" media="(max-width: 767px)">
</head>
<body>

  <!-- ===== HEADER ===== -->
  <header class="header">
    <img src="assets/images/logo.png" class="logo" alt="INCAR ë¡œê³ ">
    <div class="header-text">
      <h1>2025 ISC ëŒ€ë§Œ ì—¬í–‰</h1>
      <p class="sub">2026.03.11 ~ 03.14 | ì¸ì¹´ê¸ˆìœµì„œë¹„ìŠ¤</p>
    </div>
  </header>

  <!-- ===== LOGIN ===== -->
  <section id="loginSection" class="login">
    <h2>ì‚¬ë²ˆ ë¡œê·¸ì¸</h2>
    <input type="text" id="employeeId" placeholder="ì‚¬ë²ˆ ì…ë ¥">
    <button onclick="login()">ë¡œê·¸ì¸</button>
    <p id="loginError" class="error"></p>
  </section>

  <!-- ===== MAIN ===== -->
  <main id="mainSection" style="display:none;">
    <p class="welcome"><strong id="employeeName"></strong> ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤</p>

    <!-- ë©”ë‰´ ë²„íŠ¼ -->
    <div class="menu">
      <button onclick="openPage('schedule')">ğŸ—“ ì—¬í–‰ ì¼ì •</button>
      <button onclick="openPage('flight')">âœˆï¸ í•­ê³µí¸ ì •ë³´</button>
      <button onclick="openPage('tour')">ğŸ“ ì£¼ìš” ê´€ê´‘ì§€</button>
      <button onclick="openPage('option')">ğŸ· ì„ íƒ ê´€ê´‘</button>
      <button onclick="openPage('dinner')">ğŸ½ ë§Œì°¬ ì•ˆë‚´</button>
      <button onclick="openPage('request')">ğŸ“ ìš”ì²­ì‚¬í•­</button>
      <button onclick="openPage('contact')">ğŸ“ ê¸´ê¸‰ ì—°ë½ë§</button>
    </div>
  </main>

  <!-- ===== DETAIL PAGE (ë ˆì´ì–´ ë°©ì‹) ===== -->
  <section id="detailPage" class="detail" style="display:none;">
    <h2 id="detailTitle"></h2>
    <div id="detailContent"></div>

    <div class="nav-buttons">
      <button onclick="goHome()">í™ˆìœ¼ë¡œ</button>
      <button onclick="goBack()">ë’¤ë¡œê°€ê¸°</button>
    </div>
  </section>

  <!-- ===== SCRIPT ===== -->
  <script>
    let employees = [];
    let currentUser = null;
    let pageStack = [];

    /* ì§ì› ë°ì´í„° ë¡œë“œ */
    fetch("people/employees.json?ts=" + Date.now())
      .then(res => res.json())
      .then(data => employees = data);

    /* ë¡œê·¸ì¸ */
    function login() {
      const id = document.getElementById("employeeId").value.trim();
      const user = employees.find(e => e.id === id);

      if (!user) {
        document.getElementById("loginError").textContent = "ë“±ë¡ë˜ì§€ ì•Šì€ ì‚¬ë²ˆì…ë‹ˆë‹¤.";
        return;
      }

      currentUser = user;
      document.getElementById("employeeName").textContent = user.name;
      document.getElementById("loginSection").style.display = "none";
      document.getElementById("mainSection").style.display = "block";
    }

    /* í˜ì´ì§€ ì—´ê¸° */
    function openPage(type) {
      pageStack.push(type);
      document.getElementById("mainSection").style.display = "none";
      document.getElementById("detailPage").style.display = "block";

      const title = document.getElementById("detailTitle");
      const content = document.getElementById("detailContent");

      if (type === "flight") {
        title.textContent = "âœˆï¸ í•­ê³µí¸ ì •ë³´";
        content.innerHTML = `<p>${currentUser.flight || "í•­ê³µí¸ ì •ë³´ ì—†ìŒ"}</p>`;
      }

      if (type === "request") {
        title.textContent = "ğŸ“ ìš”ì²­ì‚¬í•­";
        content.innerHTML = `
          <textarea id="requestText" placeholder="ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
          <button onclick="submitRequest()">ì œì¶œ</button>
          <p id="submitMessage"></p>
        `;
      }

      if (type === "schedule") {
        title.textContent = "ğŸ—“ ì—¬í–‰ ì¼ì •";
        content.innerHTML = `<p>ëŒ€ë§Œ 3ë°• 4ì¼ ê³µì‹ ì¼ì • (ìƒì„¸ ì¶”í›„ ê³µê°œ)</p>`;
      }

      if (type === "contact") {
        title.textContent = "ğŸ“ ê¸´ê¸‰ ì—°ë½ë§";
        content.innerHTML = `<p>í˜„ì§€ ë‹´ë‹¹ì / í•œêµ­ ë‹´ë‹¹ì ì—°ë½ì²˜</p>`;
      }
    }

    /* ìš”ì²­ì‚¬í•­ ì „ì†¡ */
    function submitRequest() {
      const text = document.getElementById("requestText").value.trim();
      if (!text) return alert("ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");

      fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          id: currentUser.id,
          name: currentUser.name,
          request: text
        })
      });

      document.getElementById("submitMessage").textContent = "ì œì¶œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
      document.getElementById("requestText").value = "";
    }

    function goHome() {
      pageStack = [];
      document.getElementById("detailPage").style.display = "none";
      document.getElementById("mainSection").style.display = "block";
    }

    function goBack() {
      pageStack.pop();
      if (pageStack.length === 0) goHome();
    }
  </script>

</body>
</html>
