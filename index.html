<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>2026 ISC ëŒ€ë§Œ ì—¬í–‰</title>

  <!-- âœ… [1] í°íŠ¸ CDN (Pretendard) -->
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

  <style>
    /* =========================================================
       [2] CSS ë³€ìˆ˜ & ì´ˆê¸°í™”
    ========================================================= */
    :root {
      --primary-color: #1a233a; 
      --accent-color: #c5a059;  
      --bg-main: #f5f7fa;        
      --card-bg: #ffffff;
      --text-main: #2d3748;
      --text-sub: #718096;
      --border-light: #edf2f7;
      --safe-top: env(safe-area-inset-top, 20px);
      --safe-bottom: env(safe-area-inset-bottom, 20px);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent; 
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
    }

    html, body {
      margin: 0;
      padding: 0;
      background-color: var(--primary-color);
      color: var(--text-main);
      overscroll-behavior: none; 
      width: 100%;
      height: 100%;
      overflow: hidden; /* ì´ì¤‘ ìŠ¤í¬ë¡¤ ë°©ì§€ */
    }

    /* =========================================================
       [3] ë¡œê·¸ì¸ í™”ë©´
    ========================================================= */
    .mobile-splash {
      position: fixed; inset: 0; z-index: 9999;
      background: var(--primary-color);
      display: flex; align-items: center; justify-content: center;
    }
    .mobile-splash img { width: 100%; height: 100%; object-fit: cover; }

    .login-hero {
      width: 100%;
      height: 100vh;
      height: 100dvh; 
      background: url('assets/images/taiwan.jpg') center/cover no-repeat;
      position: fixed; top: 0; left: 0; z-index: 2000;
    }
    
    .hero-overlay {
      position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(26,35,58,0.85) 0%, rgba(0,0,0,0.6) 100%);
      display: flex; align-items: center; justify-content: center;
      padding: 20px;
    }

    .login-box {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 40px 24px;
      border-radius: 24px;
      width: 100%; max-width: 360px;
      text-align: center;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    /* ë¡œê³  ìŠ¤íƒ€ì¼ */
    .hero-logo { height: 36px; margin-bottom: 12px; object-fit: contain; }

    .login-box h2 { color: var(--primary-color); margin: 0 0 5px; font-weight: 800; }
    .hero-desc { color: var(--text-sub); margin-bottom: 24px; font-size: 14px; }
    
    .login-box input {
      width: 100%; padding: 14px; border: 1px solid var(--border-light);
      border-radius: 12px; font-size: 16px; margin-bottom: 12px;
      text-align: center; background: #f8fafc; transition: all 0.2s;
    }
    .login-box input:focus { border-color: var(--accent-color); outline: none; background: #fff; }
    
    .primary-btn {
      width: 100%; padding: 15px; border: none; border-radius: 12px;
      background: var(--primary-color); color: #fff; font-size: 16px; font-weight: 700;
      cursor: pointer; transition: transform 0.1s;
    }
    .primary-btn:active { transform: scale(0.98); }
    .error { color: #e53e3e; font-size: 13px; margin-top: 12px; min-height: 18px; font-weight: 500;}

    /* =========================================================
       [4] í™ˆ í™”ë©´
    ========================================================= */
    .main-bg { width: 100%; height: 100%; overflow: hidden; }
    
    .home-view {
      width: 100%;
      height: 100vh; height: 100dvh;
      background: url('assets/images/taiwan.jpg') center/cover no-repeat;
      position: relative;
      display: flex; flex-direction: column;
    }
    
    .home-overlay {
      position: absolute; inset: 0;
      background: linear-gradient(to bottom, rgba(26,35,58,0.3) 0%, rgba(26,35,58,0.95) 90%);
      z-index: 1;
    }

    /* í—¤ë” */
    .home-header {
      position: relative; z-index: 100;
      display: flex; justify-content: space-between; align-items: center;
      padding: 20px 24px;
      padding-top: max(20px, env(safe-area-inset-top));
    }
    .header-logo { height: 28px; filter: brightness(0) invert(1); opacity: 0.95; }
    
    /* ë©”ë‰´ */
    .menu-wrapper { position: relative; }
    .menu-btn {
      background: rgba(255,255,255,0.15); 
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.25); 
      color: #fff; padding: 8px 16px; 
      border-radius: 20px; font-weight: 600; font-size: 13px;
      cursor: pointer; display: flex; align-items: center; gap: 6px;
    }

    .menu-dim {
      position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 90;
      backdrop-filter: blur(4px);
      opacity: 0; visibility: hidden; transition: all 0.3s;
    }
    body.menu-open .menu-dim { opacity: 1; visibility: visible; }

    .category-dropdown {
      position: absolute; top: calc(100% + 10px); right: 0;
      width: 220px; background: #fff; border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      padding: 8px; z-index: 100;
      opacity: 0; visibility: hidden; transform: translateY(-10px) scale(0.95);
      transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
      transform-origin: top right;
    }
    body.menu-open .category-dropdown { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }

    .drop-nav button {
      width: 100%; text-align: left; background: none; border: none;
      padding: 12px; font-size: 14px; font-weight: 600; color: var(--text-main);
      border-radius: 8px; cursor: pointer; transition: background 0.2s;
      display: flex; align-items: center; gap: 10px;
    }
    .drop-nav button:active { background: #f1f5f9; }

    /* ë©”ì¸ ì½˜í…ì¸  */
    .home-main-content {
      position: relative; z-index: 10; flex: 1; 
      display: flex; flex-direction: column; justify-content: flex-end;
      padding: 0 24px 40px; 
      padding-bottom: max(40px, env(safe-area-inset-bottom));
      color: #fff;
    }
    
    .welcome-text { margin-bottom: 24px; animation: fadeInUp 0.8s ease-out; }
    .welcome-text p { font-size: 16px; margin: 0; opacity: 0.9; }
    .welcome-text strong { color: var(--accent-color); font-weight: 700; }
    .welcome-text h2 { font-size: 32px; font-weight: 800; margin: 8px 0 12px; line-height: 1.15; }
    .welcome-text .sub-date { 
        display: inline-block; padding: 4px 12px; 
        background: rgba(255,255,255,0.15); border-radius: 100px; 
        font-size: 12px; font-weight: 500; border: 1px solid rgba(255,255,255,0.1);
    }

    .day-buttons {
      display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
      animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }
    .day-btn {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 16px; border-radius: 16px;
      color: #fff; text-align: left; cursor: pointer;
      display: flex; flex-direction: column; justify-content: space-between;
      min-height: 90px;
    }
    .day-btn:active { background: rgba(255,255,255,0.2); transform: scale(0.98); }
    .day-btn-header { font-size: 16px; font-weight: 800; color: var(--accent-color); }
    .day-title { font-size: 12px; font-weight: 400; opacity: 0.8; margin-top: 6px; line-height: 1.35; }

    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* =========================================================
       [5] ìƒì„¸ í˜ì´ì§€ (í’€ìŠ¤í¬ë¦° ìˆ˜ì • ì ìš©ë¨)
    ========================================================= */
    #detailPage { position: fixed; inset: 0; z-index: 3000; display: none; }
    
    .detail-dim {
      position: absolute; inset: 0;
      background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);
      opacity: 0; transition: opacity 0.3s ease; pointer-events: none; 
    }
    
    .detail-sheet__inner {
      position: absolute; bottom: 0; left: 0; right: 0;
      /* ğŸ”¥ 1ë²ˆ ë¬¸ì œ í•´ê²°: ë†’ì´ 100% ê½‰ ì±„ìš°ê¸° */
      height: 100%; height: 100dvh; top: 0;
      
      background: var(--bg-main);
      /* ğŸ”¥ ë‘¥ê·¼ ëª¨ì„œë¦¬ ì œê±° */
      border-radius: 0;
      
      display: flex; flex-direction: column;
      transform: translateY(100%); 
      transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
    }

    body.detail-open .detail-dim { opacity: 1; pointer-events: auto; }
    body.detail-open .detail-sheet__inner { transform: translateY(0); }

    .detail-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 16px 20px; background: #fff;
      border-bottom: 1px solid var(--border-light); flex-shrink: 0; 
      /* ğŸ”¥ ë…¸ì¹˜ ì˜ì—­ ëŒ€ì‘ */
      padding-top: max(16px, env(safe-area-inset-top));
    }
    .detail-title { font-size: 17px; font-weight: 700; color: var(--primary-color); }
    .detail-actions button {
      background: #f1f5f9; border: none; font-size: 12px; color: var(--text-sub);
      padding: 8px 12px; border-radius: 8px; margin-left: 8px; cursor: pointer; font-weight: 600;
    }
    .detail-actions .btn-back { background: var(--primary-color); color: white; }

    #detailContent {
      flex: 1; overflow-y: auto; padding: 20px;
      padding-bottom: calc(40px + var(--safe-bottom));
      -webkit-overflow-scrolling: touch;
    }

    /* ì»¨í…ì¸  ìŠ¤íƒ€ì¼ */
    .day-card {
      background: var(--card-bg); border-radius: 16px; padding: 20px;
      margin-bottom: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.03);
    }
    .day-card h3 {
      margin: 0 0 16px; font-size: 18px; color: var(--primary-color);
      display: flex; align-items: baseline; gap: 8px; font-weight: 800;
      border-bottom: 2px solid #f1f5f9; padding-bottom: 12px;
    }
    .day-card h3 span { font-size: 13px; color: var(--text-sub); font-weight: 500; }
    
    /* ëŒ€ë§Œì •ë³´ ê·¸ë¦¬ë“œ */
    .country-compare-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
    .country-card { background: var(--card-bg); padding: 16px; border-radius: 16px; text-align: center; }
    .flag-img { width: 36px; border-radius: 4px; border: 1px solid var(--border-light); margin-bottom: 8px; }
    .time-box strong { display: block; font-size: 18px; color: var(--primary-color); margin-top: 4px; font-family: monospace; }

    /* í™˜ìœ¨ */
    .exchange-row {
      background: var(--primary-color); color: #fff; padding: 20px;
      border-radius: 16px; text-align: center; margin-bottom: 20px;
    }
    .fx-grid { display: grid; grid-template-columns: 1fr auto 1fr; gap: 8px; align-items: center; margin-top: 16px;}
    .fx-box input {
      width: 100%; padding: 12px; border: 1px solid var(--border-light);
      border-radius: 10px; text-align: right; font-weight: 600; font-size: 16px;
    }
    
    /* ì„ íƒê´€ê´‘ */
    .tour-card {
      background: var(--card-bg); border-radius: 16px; padding: 20px;
      margin-bottom: 16px; border-left: 4px solid var(--accent-color);
    }
    .meal-box { background: #f8fafc; padding: 12px; border-radius: 8px; margin: 12px 0; font-size: 13px; display: flex; justify-content: space-between;}
    .meal-check { display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px dashed var(--border-light); }

    /* íƒ€ì„ë¼ì¸ */
    .timeline { border-left: 2px solid #e2e8f0; margin-left: 8px; padding-left: 20px; }
    .schedule-item { position: relative; margin-bottom: 24px; }
    .timeline-dot {
      position: absolute; left: -27px; top: 4px;
      width: 12px; height: 12px; border-radius: 50%;
      background: #fff; border: 3px solid var(--accent-color);
    }
    .schedule-time { font-size: 13px; font-weight: 700; color: var(--accent-color); }
    .schedule-title { font-size: 15px; font-weight: 600; color: var(--text-main); }
    .schedule-desc { font-size: 13px; color: var(--text-sub); margin-top: 2px; }

    /* ë°ìŠ¤í¬íƒ‘ */
    @media (min-width: 768px) {
      .day-buttons { grid-template-columns: repeat(4, 1fr); }
      .home-main-content, .home-header { max-width: 800px; margin: 0 auto; width: 100%; }
      .detail-sheet__inner {
        top: 50%; left: 50%; transform: translate(-50%, -100%) scale(0.9); 
        bottom: auto; right: auto; width: 100%; max-width: 480px; height: 80vh;
        border-radius: 24px; opacity: 0;
      }
      body.detail-open .detail-sheet__inner { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
  </style>
</head>

<body>
  
<!-- ================= LOGIN SECTION ================= -->
<section id="loginSection" class="login-hero">
  <div class="hero-overlay">
    <div class="login-box">
      <!-- âœ… 2ë²ˆ ë¬¸ì œ í•´ê²°: ë¡œê³  SVG Base64 ì ìš© -->
      <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCAxMjAgNDAiPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9IjkwMCIgZm9udC1zaXplPSIyNCIgZmlsbD0iIzFhMjMzYSIgbGV0dGVyLXNwYWNpbmc9Ii0xIj5JTkNBUjwvdGV4dD4KPC9zdmc+" class="hero-logo" alt="INCAR Logo">
      <h2>2026 ISC Taiwan</h2>
      <p class="hero-desc">ì‚¬ë²ˆìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”</p>

      <input type="text" id="employeeId" placeholder="ì‚¬ë²ˆ ì…ë ¥" inputmode="numeric">
      <button class="primary-btn" onclick="login()">ë¡œê·¸ì¸</button>
      <p id="loginError" class="error"></p>
    </div>
  </div>
</section>

<!-- ================= MAIN SECTION ================= -->
<main id="mainSection" class="main-bg" style="display:none;">

  <section id="homeView" class="home-view">
    <div class="home-overlay"></div>
    <div id="menuDim" class="menu-dim" onclick="toggleMenu()"></div>
    
    <header class="home-header">
      <!-- í—¤ë” ë¡œê³  SVG ì ìš© -->
      <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCAxMjAgNDAiPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9IjkwMCIgZm9udC1zaXplPSIyNCIgZmlsbD0iI2ZmZmZmZiIgbGV0dGVyLXNwYWNpbmc9Ii0xIj5JTkNBUjwvdGV4dD4KPC9zdmc+" class="header-logo" alt="LOGO">
      
      <div class="menu-wrapper">
        <button class="menu-btn" onclick="toggleMenu()">
            <span style="font-size:16px;">â˜°</span> ë©”ë‰´
        </button>
        <div id="categoryDropdown" class="category-dropdown">
          <div class="dropdown-header">Categories</div>
          <nav class="drop-nav">
            <button onclick="openPage('taiwan')"><span>ğŸ‡¹ğŸ‡¼ ëŒ€ë§Œ ì •ë³´</span></button>
            <button onclick="openPage('exchange')"><span>ğŸ’± í™˜ìœ¨ ê³„ì‚°</span></button>  
            <button onclick="openPage('flight')"><span>âœˆï¸ í•­ê³µí¸</span></button>
            <button onclick="openPage('myTour')"><span>ğŸ’ ë‚˜ì˜ ì„ íƒê´€ê´‘</span></button>
            <button onclick="openPage('dinner')"><span>ğŸ½ ë§Œì°¬ ì•ˆë‚´</span></button>
            <button onclick="openPage('request')"><span>ğŸ“ ìš”ì²­ì‚¬í•­</span></button>
            <button onclick="openPage('contact')"><span>ğŸ“ ë¹„ìƒ ì—°ë½</span></button>
          </nav>
        </div>
      </div>
    </header>

    <div class="home-main-content">
      <div class="welcome-text">
        <p><strong id="employeeName">User</strong> ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤</p>
        <h2>ISC Taiwan<br>ì—¬ì •ì˜ ì‹œì‘</h2>
        <span class="sub-date">D-25 | 2026.03.11 ~ 14</span>
      </div>

      <div class="day-buttons">
        <button class="day-btn" onclick="openPage('day_0')">
          <span class="day-btn-header">DAY 1</span>
          <span class="day-title">ì¸ì²œ ì¶œë°œ &<br>ì‹œë‚´ í•˜ì´ë¼ì´íŠ¸</span>
        </button>
        <button class="day-btn" onclick="openPage('day_1')">
          <span class="day-btn-header">DAY 2</span>
          <span class="day-title">ì„ íƒ ê´€ê´‘ &<br>ISC ê³µì‹ ë§Œì°¬</span>
        </button>
        <button class="day-btn" onclick="openPage('day_2')">
          <span class="day-btn-header">DAY 3</span>
          <span class="day-title">ê·¼êµ ê´€ê´‘ &<br>ììœ  ì¼ì •</span>
        </button>
        <button class="day-btn" onclick="openPage('day_3')">
          <span class="day-btn-header">DAY 4</span>
          <span class="day-title">íƒ€ì´ë² ì´ ì¶œë°œ &<br>ì¸ì²œ ê·€êµ­</span>
        </button>
      </div>
    </div>
  </section>

<!-- ================= DETAIL SHEET ================= -->
<section id="detailPage" class="detail-sheet">
  <div class="detail-dim" onclick="goHome()"></div>
  <div class="detail-sheet__inner" onclick="event.stopPropagation()">
      <div class="detail-header">
        <div class="detail-title" id="detailTitle">ìƒì„¸ ì •ë³´</div>
        <div class="detail-actions">
          <button class="btn-home" onclick="goHome()">ë‹«ê¸°</button>
          <button class="btn-back" onclick="goBack()">ë’¤ë¡œ</button>
        </div>
      </div>
    <div id="detailContent"></div>
  </div>
</section>

</main>

<script>
/* ================= DATA & LOGIC ================= */
let pageHistory = [];
let employees = [];
let currentUser = null;
const ADMIN_PASSWORD = "0000"; 

// ğŸš¨ 4ë²ˆ ë¬¸ì œ í•´ê²°: ë¹„ìƒìš© ë°±ì—… ë°ì´í„° (ë¯¸ë¦¬ë³´ê¸°/ì˜¤í”„ë¼ì¸ìš©)
// íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì´ ë°ì´í„°ë¡œ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.
const EMBEDDED_BACKUP_DATA = [
  {
    "id": "1612156", "name": "ë°•ìƒí˜„",
    "flight": { "departure": { "date": "2026.03.11", "time": "09:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ëŒ€í•œí•­ê³µ", "flightNo": "KE 2021" }, "return": { "date": "2026.03.14", "time": "12:25", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ëŒ€í•œí•­ê³µ", "flightNo": "KE 2022" } },
    "myTour": ["í‹°ì—”ë¼ì´"]
  },
  {
    "id": "1612001", "name": "ê¹€í•´ë¹›ë‚˜",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["ììœ ì¼ì •"]
  },
  {
    "id": "1612163", "name": "ì´ì€ì§€",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["í‹°ì—”ë¼ì´", "ê³ ê¶ë°•ë¬¼ê´€", "ììœ ì¼ì •"]
  },
  {
    "id": "1611391", "name": "ë‚¨ìš±í˜„",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["ê³ ê¶ë°•ë¬¼ê´€"]
  },
  {
    "id": "1611499", "name": "ìµœì§„ìš°",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["í‹°ì—”ë¼ì´", "ê³ ê¶ë°•ë¬¼ê´€", "ììœ ì¼ì •"]
  },
  {
    "id": "1612164", "name": "ì´ì œí›ˆ",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["í‹°ì—”ë¼ì´", "ê³ ê¶ë°•ë¬¼ê´€", "ììœ ì¼ì •"]
  },
  {
    "id": "1611836", "name": "ì‹ í˜„í•˜",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["í‹°ì—”ë¼ì´", "ê³ ê¶ë°•ë¬¼ê´€", "ììœ ì¼ì •"]
  },
  {
    "id": "1612022", "name": "í˜„ë³´ë¼",
    "flight": { "departure": { "date": "2026.03.11", "time": "08:00", "from": "ì¸ì²œ", "to": "íƒ€ì´ë² ì´", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 711" }, "return": { "date": "2026.03.14", "time": "11:40", "from": "íƒ€ì´ë² ì´", "to": "ì¸ì²œ", "airline": "ì•„ì‹œì•„ë‚˜í•­ê³µ", "flightNo": "OZ 712" } },
    "myTour": ["í‹°ì—”ë¼ì´", "ê³ ê¶ë°•ë¬¼ê´€", "ììœ ì¼ì •"]
  }
];

// ë°ì´í„° ë¡œë“œ (ìš°ì„ ìˆœìœ„: JSON íŒŒì¼ > ì‹¤íŒ¨ì‹œ ë°±ì—… ë°ì´í„°)
fetch("people/employees.json?ts=" + Date.now())
  .then(res => {
     if (!res.ok) throw new Error("JSON Fetch Failed"); 
     return res.json();
  })
  .then(data => {
    employees = data;
    console.log("âœ… ì„œë²„ ë°ì´í„° ë¡œë“œ ì„±ê³µ");
    tryAutoLogin(); 
  })
  .catch(err => {
    console.warn("âš ï¸ JSON ë¡œë“œ ì‹¤íŒ¨! ë¹„ìƒìš© ë°±ì—… ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.");
    employees = EMBEDDED_BACKUP_DATA;
    tryAutoLogin();
  });

/* ================= ì¼ì • ë°ì´í„° ================= */
const travelSchedule = [
  {
    day: "DAY 1", date: "2026.03.11 (ìˆ˜)", title: "ì¸ì²œ â†’ íƒ€ì´ë² ì´ / ì‹œë‚´ í•˜ì´ë¼ì´íŠ¸",
    items: [
      { time:"08:00/9:00", icon:"âœˆï¸", title:"ì¸ì²œ êµ­ì œê³µí•­ ì¶œë°œ", desc:"OZ 711 / KE 2021" },
      { time:"12:30/13:30", icon:"ğŸœ", title:"ì¤‘ì‹ | ìš°ìœ¡ë©´", desc:"í˜„ì§€ ì¸ê¸° ì¤‘ì‹ë‹¹" },
      { time:"13:30/14:30", icon:"ğŸ›ï¸", title:"ë‹¨ìˆ˜ì´ ì˜›ê±°ë¦¬/í™ë§ˆì˜¤ì²­", desc:"í™ë§ˆì˜¤ì²­Â·ì˜›ê±°ë¦¬ ê´€ê´‘" },
      { time:"16:30/17:30", icon:"ğŸ¨", title:"í˜¸í…” ì²´í¬ì¸", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”" },
      { time:"18:00/18:30", icon:"ğŸ½ï¸", title:"ì„ì‹ | ë¬´ì œí•œ ìƒ¤ë¸Œìƒ¤ë¸Œ", desc:"í˜„ì§€ íŠ¹ì‹" },
      { time:"19:30/20:00", icon:"ğŸŒƒ", title:"íƒ€ì´ë² ì´ 101 ì „ë§ëŒ€", desc:"ì•¼ê²½ ê´€ëŒ" }
    ]
  },
  {
    day: "DAY 2", date: "2026.03.12 (ëª©)", title: "ì„ íƒ ê´€ê´‘ / ë§Œì°¬",
    items: [ /* ë™ì  ìƒì„± */ ]
  },
  {
    day: "DAY 3", date: "2026.03.13 (ê¸ˆ)", title: "ê·¼êµ ê´€ê´‘",
    items: [
      { time:"10:00", icon:"ğŸ¨", title:"í˜¸í…” ì¡°ì‹ í›„ ì¶œë°œ", desc:"ë©”ë¦¬ì–´íŠ¸ í˜¸í…”" },
      { time:"11:00", icon:"ğŸŒŠ", title:"ì•¼ë¥˜ í•´ìƒê³µì›", desc:"ê¸°ì•”ê´´ì„ ê´€ê´‘" },
      { time:"12:30", icon:"ğŸ¦", title:"ì¤‘ì‹ : ì”¨í‘¸ë“œ", desc:"í˜„ì§€ í•´ì‚°ë¬¼ íŠ¹ì‹" },
      { time:"14:30", icon:"ğŸ®", title:"ìŠ¤í€ ì²œë“±ë‚ ë¦¬ê¸°", desc:"ì†Œì›ì²œë“± ë‚ ë¦¬ê¸°" },
      { time:"17:00", icon:"ğŸ®", title:"ì§€ìš°í€ ì•¼ê²½", desc:"í™ë“±ë§ˆì„" },
      { time:"20:00", icon:"ğŸœ", title:"ì•¼ì‹œì¥ íˆ¬ì–´", desc:"ììœ ì„ì‹ ë° ì‡¼í•‘" }
    ]
  },
  {
    day: "DAY 4", date: "2026.03.14 (í† )", title: "ê·€êµ­",
    items: [
      { time:"08:00", icon:"ğŸ¨", title:"ì²´í¬ì•„ì›ƒ", desc:"ì¡°ì‹ í›„ ì´ë™" },
      { time:"11:40/12:25", icon:"âœˆï¸", title:"íƒ€ì´ë² ì´ ì¶œë°œ", desc:"OZ 712 / KE 2022" },
      { time:"15:25/15:50", icon:"ğŸ‡°ğŸ‡·", title:"ì¸ì²œ ë„ì°©", desc:"ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤" }
    ]
  }
];

// ì„ íƒê´€ê´‘ ë°ì´í„°
const myTourTemplates = [
  { keyword: "í‹°ì—”ë¼ì´", html: `<div class="tour-card"><div class="tour-header"><span class="badge" style="background:#dcfce7; color:#166534;">ì„ íƒ 1ì•ˆ</span><h3 style="margin:5px 0 0;">í‹°ì—”ë¼ì´ ì˜¨ì²œ íë§</h3></div><p class="tour-desc">ì–‘ëª…ì‚° êµ­ë¦½ê³µì› ìë½ì˜ ìµœê³ ê¸‰ ìœ í™© ì˜¨ì²œ ì²´í—˜</p><div class="meal-box"><strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong><span style="color:#166534; font-weight:bold;">ì‹ì‚¬ í¬í•¨ (ë² ì´ì§•ë•)</span></div></div>` },
  { keyword: "ê³ ê¶ë°•ë¬¼ê´€", html: `<div class="tour-card"><div class="tour-header"><span class="badge" style="background:#dbeafe; color:#1e40af;">ì„ íƒ 2ì•ˆ</span><h3 style="margin:5px 0 0;">ê³ ê¶ë°•ë¬¼ê´€ ì—­ì‚¬ ê¸°í–‰</h3></div><p class="tour-desc">ì„¸ê³„ 4ëŒ€ ë°•ë¬¼ê´€, ì¤‘êµ­ ì—­ì‚¬ì˜ ì •ìˆ˜ ê´€ëŒ</p><div class="meal-box"><strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong><span style="color:#166534; font-weight:bold;">ì‹ì‚¬ í¬í•¨ (ë² ì´ì§•ë•)</span></div></div>` },
  { keyword: "ììœ ì¼ì •", html: `<div class="tour-card" style="border-left-color:#ef4444;"><div class="tour-header"><span class="badge" style="background:#fee2e2; color:#991b1b;">ì„ íƒ 3ì•ˆ</span><h3 style="margin:5px 0 0;">ììœ ë¡œìš´ ëŒ€ë§Œ ì—¬í–‰</h3></div><p class="tour-desc">ê°€ì´ë“œ/ì°¨ëŸ‰ ì—†ì´ ììœ ë¡­ê²Œ ì¦ê¸°ëŠ” ì¼ì •</p><div class="meal-box"><strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong><span style="color:#ef4444; font-weight:bold;">ë¶ˆí¬í•¨ (í˜„ê¸ˆ ì§€ê¸‰)</span></div><div class="meal-check" data-tour="ììœ ì¼ì •"><span class="status pending" style="color:#ef4444;">ì¤‘ì‹ë¹„ ë¯¸ì§€ê¸‰</span><button onclick="handleMealClick(this)">ì§€ê¸‰ í™•ì¸</button></div></div>` }
];

/* ================= ê¸°ëŠ¥ ë¡œì§ ================= */

function toggleMenu() {
  document.body.classList.toggle('menu-open');
}

function login() {
  const id = document.getElementById("employeeId").value.trim();
  const user = employees.find(e => e.id === id);

  if (!user) {
    if (employees.length === 0) {
        document.getElementById("loginError").innerText = "ë°ì´í„° ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ì‹œë„í•´ì£¼ì„¸ìš”.";
        return;
    }
    document.getElementById("loginError").innerText = "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ë²ˆì…ë‹ˆë‹¤.";
    return;
  }
  
  currentUser = user;
  document.getElementById("loginSection").style.display = "none";
  document.getElementById("mainSection").style.display = "block";
  document.getElementById("employeeName").textContent = currentUser.name;
}

function tryAutoLogin() {
  const params = new URLSearchParams(window.location.search);
  const eid = params.get("eid");
  if (eid) {
    document.getElementById("employeeId").value = eid;
    if(employees.length > 0) login();
  }
}

function openPage(type, fromHistory = false) {
  document.body.classList.remove('menu-open');
  if (!fromHistory) pageHistory.push(type);

  const detail = document.getElementById("detailPage");
  detail.style.display = "block";
  void detail.offsetWidth; 
  document.body.classList.add("detail-open");

  const t = document.getElementById("detailTitle");
  const c = document.getElementById("detailContent");
  c.innerHTML = "";

  // 1. ì¼ì • í˜ì´ì§€
  if (type.startsWith("day_")) {
    const idx = parseInt(type.split("_")[1]);
    const day = travelSchedule[idx];
    t.textContent = day.day + " ì¼ì •";
    
    // Day 2 ì„ íƒê´€ê´‘ ë¡œì§ ì²˜ë¦¬
    let items = day.items;
    if (day.day === "DAY 2") {
        items = [
            { time:"09:00", icon:"ğŸšŒ", title:"ì„ íƒ ê´€ê´‘ ì§„í–‰", desc:"ë³¸ì¸ì´ ì„ íƒí•œ ì½”ìŠ¤ë¡œ ì´ë™" },
            { time:"12:30", icon:"ğŸ½ï¸", title:"ì¤‘ì‹", desc:"ì„ íƒì•ˆ ë³„ ìƒì´" },
            { time:"18:00", icon:"ğŸ‰", title:"ISC ë§Œì°¬", desc:"ê·¸ëœë“œ ë³¼ë£¸" }
        ];
    }

    let html = `<div class="day-card"><h3>${day.day} <span>${day.date}</span></h3><div class="timeline">`;
    items.forEach(i => {
        html += `
        <div class="schedule-item">
            <div class="timeline-dot"></div>
            <div class="schedule-time">${i.time}</div>
            <div class="schedule-title">${i.icon} ${i.title}</div>
            <div class="schedule-desc">${i.desc}</div>
        </div>`;
    });
    html += `</div></div>`;
    c.innerHTML = html;
  }
  
  // âœ… 3ë²ˆ ë¬¸ì œ í•´ê²°: ëŒ€ë§Œ ì •ë³´ ë³µêµ¬
  else if (type === "taiwan") {
      t.textContent = "ëŒ€ë§Œ ì •ë³´";
      c.innerHTML = `
      <div class="country-compare-grid">
        <div class="country-card">
            <img src="assets/images/flag-kr.jpg" class="flag-img" onerror="this.style.display='none'">
            <div style="font-weight:bold; margin-bottom:5px;">í•œêµ­ (KR)</div>
            <div class="time-box"><span>í˜„ì¬ ì‹œê°</span><strong id="timeKR">--:--</strong></div>
        </div>
        <div class="country-card">
            <img src="assets/images/flag-tw.jpg" class="flag-img" onerror="this.style.display='none'">
            <div style="font-weight:bold; margin-bottom:5px;">ëŒ€ë§Œ (TW)</div>
            <div class="time-box"><span>í˜„ì¬ ì‹œê°</span><strong id="timeTW" style="color:#c5a059;">--:--</strong></div>
        </div>
      </div>
      <div class="exchange-row">í™˜ìœ¨: <strong>1 TWD â‰ˆ 42ì›</strong></div>
      <div class="day-card">
        <h3>ê¸°ë³¸ ì •ë³´</h3>
        <ul style="padding-left:20px; line-height:2; font-size:14px; color:#4b5563;">
            <li><strong>ì „ì••:</strong> 110V (ë¼ì§€ì½” í•„ìš”)</li>
            <li><strong>ë‚ ì”¨:</strong> í‰ê·  20ë„ (ê°€ì„ ë‚ ì”¨)</li>
            <li><strong>ì‹œì°¨:</strong> í•œêµ­ë³´ë‹¤ 1ì‹œê°„ ëŠë¦¼</li>
        </ul>
      </div>
      `;
      startTimeTick();
  }
  else if (type === "exchange") {
      t.textContent = "í™˜ìœ¨ ê³„ì‚°ê¸°";
      c.innerHTML = `
        <div class="exchange-row">ê¸°ì¤€ í™˜ìœ¨<br><strong style="font-size:24px;">1 TWD â‰ˆ 42 KRW</strong></div>
        <div class="day-card">
            <div class="fx-grid">
                <div class="fx-box"><label>ëŒ€ë§Œ (TWD)</label><input type="number" id="twInput" placeholder="0" oninput="calc('tw')"></div>
                <div style="text-align:center; color:#ccc;">â‡„</div>
                <div class="fx-box"><label>í•œêµ­ (KRW)</label><input type="number" id="krInput" placeholder="0" oninput="calc('kr')"></div>
            </div>
        </div>
      `;
  }
  else if (type === "myTour") {
      t.textContent = "ë‚˜ì˜ ì„ íƒê´€ê´‘";
      const userTours = currentUser.myTour || ["ììœ ì¼ì •"];
      const rendered = myTourTemplates.filter(t => userTours.some(u => t.keyword.includes(u) || u.includes(t.keyword)));
      if(rendered.length === 0) c.innerHTML = `<div class="day-card" style="text-align:center; padding:40px;">ì„ íƒí•œ ê´€ê´‘ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
      else c.innerHTML = rendered.map(r => r.html).join("");
  }
  else if (type === "flight") {
    const dep = currentUser.flight.departure;
    const ret = currentUser.flight.return;
    t.textContent = "âœˆï¸ í•­ê³µí¸ ì •ë³´";
    c.innerHTML = `
      <div class="day-card"><h3>ì¶œêµ­í¸</h3><div class="timeline"><div class="schedule-item"><div class="timeline-dot"></div><div class="schedule-time">${dep.time}</div><div class="schedule-title">âœˆï¸ ${dep.from} â†’ ${dep.to}</div><div class="schedule-desc">${dep.airline} ${dep.flightNo}</div></div></div></div>
      <div class="day-card"><h3>ê·€êµ­í¸</h3><div class="timeline"><div class="schedule-item"><div class="timeline-dot"></div><div class="schedule-time">${ret.time}</div><div class="schedule-title">ğŸ  ${ret.from} â†’ ${ret.to}</div><div class="schedule-desc">${ret.airline} ${ret.flightNo}</div></div></div></div>
    `;
  }
  else if (type === "request") {
    t.textContent = "ğŸ“ ìš”ì²­ì‚¬í•­";
    c.innerHTML = `<div class="day-card"><textarea id="requestInput" style="width:100%; height:120px; padding:10px; border:1px solid #edf2f7; border-radius:8px;" placeholder="ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea><button class="primary-btn" style="margin-top:10px;" onclick="alert('ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤')">ì œì¶œí•˜ê¸°</button></div>`;
  }
  else if (type === "contact") {
    t.textContent = "ğŸ“ ë¹„ìƒ ì—°ë½ë§";
    c.innerHTML = `
      <div class="day-card">
        <div class="timeline">
          <div class="schedule-item"><div class="timeline-dot"></div><div class="schedule-title">ì¸ì¹´ë¸”ë£¨íˆ¬ì–´</div><div class="schedule-desc">010-0000-0000</div></div>
          <div class="schedule-item"><div class="timeline-dot"></div><div class="schedule-title">í˜„ì§€ ê°€ì´ë“œ</div><div class="schedule-desc">+886-900-000-000</div></div>
        </div>
      </div>
    `;
  }
  else {
      t.textContent = "ì¤€ë¹„ ì¤‘";
      c.innerHTML = `<div class="day-card" style="text-align:center; padding:40px; color:#999;">ì¤€ë¹„ ì¤‘ì¸ í˜ì´ì§€ì…ë‹ˆë‹¤.</div>`;
  }
}

function goHome() {
  document.body.classList.remove("detail-open");
  document.body.classList.remove("menu-open");
  pageHistory = [];
  setTimeout(() => { document.getElementById("detailPage").style.display = "none"; }, 400);
}

function goBack() {
    pageHistory.pop();
    if(pageHistory.length > 0) openPage(pageHistory[pageHistory.length-1], true);
    else goHome();
}

// ì‹œê³„
function startTimeTick() {
    setInterval(() => {
        const now = new Date();
        const k = new Date(now.getTime());
        const t = new Date(now.getTime() - 3600000);
        const fmt = d => d.toTimeString().split(' ')[0];
        if(document.getElementById("timeKR")) document.getElementById("timeKR").innerText = fmt(k);
        if(document.getElementById("timeTW")) document.getElementById("timeTW").innerText = fmt(t);
    }, 1000);
}

// í™˜ìœ¨
function calc(mode) {
    const rate = 42;
    const tw = document.getElementById("twInput");
    const kr = document.getElementById("krInput");
    if(mode === 'tw') kr.value = (tw.value * rate).toFixed(0);
    else tw.value = (kr.value / rate).toFixed(1);
}

// ì¤‘ì‹ë¹„ ì§€ê¸‰
function handleMealClick(btn) {
    const wrap = btn.closest('.meal-check');
    if(wrap.classList.contains('done')) return;
    const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
    if(pw === "0000") {
        wrap.classList.add('done');
        wrap.querySelector('.status').innerText = "ì§€ê¸‰ ì™„ë£Œ";
        wrap.querySelector('.status').classList.remove('pending');
        wrap.querySelector('.status').style.color = "#166534";
        btn.innerText = "í™•ì¸ ì™„ë£Œ";
        btn.style.background = "#ddd";
    } else {
        alert("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜");
    }
}
</script>
</body>
</html>
