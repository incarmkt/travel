<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 ISC ëŒ€ë§Œ ì—¬í–‰</title>

  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/desktop.css" media="(min-width: 768px)">
  <!-- <link rel="stylesheet" href="css/mobile.css" media="(max-width: 767px)"> -->
  <link rel="stylesheet" href="css/theme-premium.css">
</head>

<body>
  
<!-- âœ… ì—¬ê¸°, body ì‹œì‘í•˜ìë§ˆì -->
<div id="mobileSplash" class="mobile-splash" style="display:none;">
  <img src="assets/images/iscposter.jpg" alt="ISC Poster">
</div>
  

<!-- ================= LOGIN (FINAL / DO NOT TOUCH) ================= -->
<section id="loginSection" class="login-hero">
  <div class="hero-overlay">
    <div class="login-box">
      <img src="assets/images/logo.png" class="hero-logo">
      <h2>2025 ISC Taiwan</h2>
      <p class="hero-desc">ì‚¬ë²ˆìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”</p>

      <input type="text" id="employeeId" placeholder="ì‚¬ë²ˆ ì…ë ¥">
      <button class="primary-btn" onclick="login()">ë¡œê·¸ì¸</button>
      <p id="loginError" class="error"></p>
    </div>
  </div>
</section>

<!-- ================= MAIN (LOGIN AFTER) ================= -->
<main id="mainSection" class="main-bg" style="display:none;">

  <!-- ================= HOME VIEW ================= -->
<section id="homeView" class="home-view">
  
 <!-- 1ï¸âƒ£ INTRO (ê¸€ì”¨ í™”ë©´) -->
  <section class="home-intro">
   <div class="intro-stage">
      <div class="top-bar">
<img src="assets/images/logo.png" class="top-logo">

<div class="top-info">
    <h1>2025 ISC ëŒ€ë§Œ ì—¬í–‰</h1>
    <p>2026.03.11 ~ 03.14 | ì¸ì¹´ê¸ˆìœµì„œë¹„ìŠ¤</p>
  </div>

  <div class="profile-box">
    <div class="profile-icon">ğŸ‘¤</div>
    <div class="profile-text">
      <strong id="employeeName"></strong> ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤<br>
      <span>ISC ë‹¬ì„±ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤</span>
    </div>
  </div>
</div>

  <!-- ê°ì„± ì¹´í”¼ ì˜ì—­ -->
<div class="hero-copy">
  <h2>ISC Taiwan 2025</h2>
  <p>ì§€ê¸ˆë¶€í„° ì—¬ì •ì´ ì‹œì‘ë©ë‹ˆë‹¤</p>
</div>

 <div class="scroll-hint">
      â†“ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ í•˜ì„¸ìš”
    </div>
  </section>

  <!-- 2ï¸âƒ£ MENU (ì¹´í…Œê³ ë¦¬ í™”ë©´) -->
  <section class="home-menu-section">
    <div class="home-menu-wrap">
      <nav class="home-menu">
      <button onclick="openPage('taiwan')">ğŸ‡¹ğŸ‡¼ ëŒ€ë§Œì˜ ëª¨ë“  ê²ƒ</button>
      <button onclick="openPage('schedule')">ğŸ—“ ì—¬í–‰ ì¼ì •</button>
      <button onclick="openPage('flight')">âœˆï¸ í•­ê³µí¸ ì •ë³´</button>
      <button onclick="openPage('myTour')">ğŸ’ ë‚˜ì˜ ì„ íƒ ê´€ê´‘</button>
      <button onclick="openPage('dinner')">ğŸ½ ë§Œì°¬ ì•ˆë‚´</button>
      <button onclick="openPage('request')">ğŸ“ ìš”ì²­ì‚¬í•­</button>
      <button onclick="openPage('contact')">ğŸ“ ê¸´ê¸‰ ì—°ë½ë§</button>
    </nav>
 </div>
 </section>

  </section>

  <!-- ================= DETAIL OVERLAY (BOTTOM SHEET) ================= -->
<section id="detailPage" class="detail-sheet" onclick="goHome()">
  <div class="detail-sheet__inner" onclick="event.stopPropagation()">
      <h2 id="detailTitle"></h2>
      <div id="detailContent"></div>

      <div class="nav-buttons">
        <!-- ğŸ”¥ onclick ì œê±° -->
        <button class="ghost-btn">í™ˆìœ¼ë¡œ</button>

        <!-- ë’¤ë¡œê°€ê¸°ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ -->
        <button class="ghost-btn" onclick="goBack()">ë’¤ë¡œê°€ê¸°</button>
      </div>
  </div>

</section>


</main>
  <script>
/* ================= ê³µí†µ ================= */
    /* ================= í˜ì´ì§€ íˆìŠ¤í† ë¦¬ ================= */
let pageHistory = [];
let employees = [];
let currentUser = null;
const ADMIN_PASSWORD = "0000";
    
    /* ================= ì„ íƒê´€ê´‘ í…œí”Œë¦¿ ================= */
const myTourTemplates = [
  {
    keyword: "í‹°ì—”ë¼ì´",
    html: `
      <div class="tour-card green">
        <div class="tour-header">
          <span class="badge">ì„ íƒ 1ì•ˆ</span>
          <h3>í‹°ì—”ë¼ì´ ì˜¨ì²œ íë§</h3>
          <span class="icon">ğŸŒ¿</span>
        </div>

        <p class="tour-desc">
          í‹°ì—”ë¼ì´ ì˜¨ì²œìš• & ì–‘ëª…ì‚° êµ­ë¦½ê³µì› ìë½ì˜ ìµœê³ ê¸‰ ìœ í™© ì˜¨ì²œ
        </p>

        <div class="meal-box">
          <strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong>
          <span>ë² ì´ì§•ë•</span>
          <em class="included">ì‹ì‚¬ í¬í•¨</em>
        </div>

        <div class="tour-footer">
          <span>ğŸ« ì…ì¥ê¶Œ</span>
          <span>ğŸšŒ ì „ìš©ì°¨ëŸ‰</span>
          <span>ğŸ´ ì¤‘ì‹</span>
        </div>
      </div>
    `
  },
  {
    keyword: "ê³ ê¶ë°•ë¬¼ê´€",
    html: `
      <div class="tour-card green">
        <div class="tour-header">
          <span class="badge">ì„ íƒ 2ì•ˆ</span>
          <h3>ê³ ê¶ë°•ë¬¼ê´€ ì—­ì‚¬ ê¸°í–‰</h3>
          <span class="icon">ğŸ›ï¸</span>
        </div>

        <p class="tour-desc">
          ì¤‘êµ­ ì—­ì‚¬ì˜ ì •ìˆ˜, ëŒ€ë§Œ ê³ ê¶ë°•ë¬¼ê´€
        </p>

        <div class="meal-box">
          <strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong>
          <span>ë² ì´ì§•ë•</span>
          <em class="included">ì‹ì‚¬ í¬í•¨</em>
        </div>

        <div class="tour-footer">
          <span>ğŸ« ì…ì¥ê¶Œ</span>
          <span>ğŸšŒ ì „ìš©ì°¨ëŸ‰</span>
          <span>ğŸ´ ì¤‘ì‹</span>
        </div>
      </div>
    `
  },
  {
    keyword: "ììœ ì¼ì •",
    html: `
      <div class="tour-card red">
        <div class="tour-header">
          <span class="badge">ì„ íƒ 3ì•ˆ</span>
          <h3>ììœ ë¡œìš´ ëŒ€ë§Œ ì—¬í–‰</h3>
          <span class="icon">ğŸ‡¹ğŸ‡¼</span>
        </div>

        <p class="tour-desc">
          ììœ ì¼ì • ëŒ€ë§Œ
        </p>

        <div class="meal-box">
          <strong>ğŸ½ ì ì‹¬ ì‹ì‚¬</strong>
          <span>ììœ ì‹</span>
          <em class="cash">í˜„ê¸ˆ ì§€ê¸‰</em>
        </div>
        
<!-- ğŸ”½ ì—¬ê¸° ì¶”ê°€ -->
     <div class="meal-check" data-tour="ììœ ì¼ì •">
  <span class="status pending">ì¤‘ì‹ë¹„ ë¯¸ì§€ê¸‰</span>
  <button onclick="handleMealClick(this)">ì§€ê¸‰ í™•ì¸</button>
</div>
      
        <div class="tour-footer">
          <span>ğŸšŒ ììœ ì¼ì •</span>
          <span>ğŸœ ì¤‘ì‹ë¹„</span>
        </div>
      </div>
    `
  }
];

/* ================= ì„ íƒê´€ê´‘ ë Œë”ë§ í•¨ìˆ˜ ================= */
function renderMyTour() {
  const selected = currentUser.myTour || [];

  const matchedCards = myTourTemplates.filter(t =>
    selected.some(input => input.includes(t.keyword))
  );

  if (matchedCards.length === 0) {
    return `<div class="card">ì„ íƒëœ ê´€ê´‘ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
  }

  return matchedCards.map(t => t.html).join("");
}

fetch("people/employees.json?ts=" + Date.now())
  .then(res => res.json())
  .then(data => {
    employees = data;
    tryAutoLogin(); // ğŸ”¥ ì´ í•œ ì¤„ì´ ì—†ì–´ì„œ ì•ˆ ëë˜ ê±°
  });

/* ================= ì¤‘ì‹ë¹„ ì§€ê¸‰ ë¡œì§ ================= */

// â‘  ë²„íŠ¼ ëˆŒë €ì„ ë•Œ ë¶„ê¸° ì²˜ë¦¬
function handleMealClick(btn) {
  const wrap = btn.closest(".meal-check");
  const tour = wrap.dataset.tour;

  const isDone = wrap.classList.contains("done");

  if (isDone) {
    showMealDetail(wrap);
  } else {
    approveMeal(wrap, tour);
  }
}

// â‘¡ ë¯¸ì§€ê¸‰ â†’ ì§€ê¸‰ ì²˜ë¦¬
function approveMeal(wrap, tour) {
  const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥");
  if (pw !== ADMIN_PASSWORD) {
    alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    return;
  }

  const time = nowKSTString();

 setMealUI(wrap, "DONE", time);
saveMealPaid(currentUser.id, tour, time);

logMealPaymentToSheet({
  action: "APPROVE",
  tour,
  time
});
}
    function setMealUI(wrap, mode, time = "") {
  const status = wrap.querySelector(".status");
  const btn = wrap.querySelector("button");

  if (mode === "DONE") {
    wrap.classList.add("done");
    status.textContent = "ì¤‘ì‹ë¹„ ì§€ê¸‰ ì™„ë£Œ";
    status.classList.remove("pending");
    status.classList.add("done");
    wrap.dataset.time = time;
    btn.textContent = "ì§€ê¸‰ í™•ì¸";
  } else {
    wrap.classList.remove("done");
    status.textContent = "ì¤‘ì‹ë¹„ ë¯¸ì§€ê¸‰";
    status.classList.add("pending");
    status.classList.remove("done");
    wrap.dataset.time = "";
    btn.textContent = "ì§€ê¸‰ í™•ì¸";
  }
}
    
function mealKey(userId, tour) {
  return `mealPaid_${userId}_${tour}`;
}
    function saveMealPaid(userId, tour, time) {
  localStorage.setItem(
    mealKey(userId, tour),
    JSON.stringify({ time })
  );
}

function loadMealPaid(userId, tour) {
  const raw = localStorage.getItem(mealKey(userId, tour));
  return raw ? JSON.parse(raw) : null;
}

function removeMealPaid(userId, tour) {
  localStorage.removeItem(mealKey(userId, tour));
}

// â‘¢ ì§€ê¸‰ ì™„ë£Œ ìƒíƒœì—ì„œ ëˆŒë €ì„ ë•Œ (í™•ì¸/ì·¨ì†Œ)
function showMealDetail(wrap) {
  const time = wrap.dataset.time;

  const pw = prompt(
    `ì§€ê¸‰ ì™„ë£Œ ì‹œê°\n${time}\n\nì·¨ì†Œí•˜ë ¤ë©´ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥\n(í™•ì¸ë§Œ ë³´ë ¤ë©´ ì·¨ì†Œ)`
  );

  if (!pw) return;
  if (pw !== ADMIN_PASSWORD) {
    alert("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜");
    return;
  }

  if (confirm("ì§€ê¸‰ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    const tour = wrap.dataset.tour;
    const cancelTime = nowKSTString();

  setMealUI(wrap, "PENDING");
removeMealPaid(currentUser.id, tour);

logMealPaymentToSheet({
  action: "CANCEL",
  tour,
  time: cancelTime
});
  }
}
function nowKSTString() {
  return new Intl.DateTimeFormat("ko-KR", {
    timeZone: "Asia/Seoul",
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit"
  }).format(new Date());
}
    const MEAL_SHEET_URL = "https://script.google.com/macros/s/AKfycbx2tVkT00Z8uXQWl6EeTIUUhZ3_NJHx3JDqSCHC5oJWkUCm0OtcTmaV6g20cNKoh0no9w/exec";

function logMealPaymentToSheet(payload) {
  if (!currentUser) return;

  fetch(MEAL_SHEET_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify({
      type: "meal",              // âœ… ì¤‘ì‹ë¹„ ë¡œê·¸ëŠ” ë¬´ì¡°ê±´ meal
      id: currentUser.id,
      name: currentUser.name,
      action: payload.action,    // APPROVE / CANCEL
      tour: payload.tour,
      time: payload.time
    })
  }).catch(console.error);
}
    
    
function login() {
  const id = document.getElementById("employeeId").value.trim();
  const user = employees.find(e => e.id === id);

  if (!user) {
    document.getElementById("loginError").textContent = "ë“±ë¡ë˜ì§€ ì•Šì€ ì‚¬ë²ˆì…ë‹ˆë‹¤.";
    return;
  }

  currentUser = user;

  // ë¡œê·¸ì¸ í™”ë©´ ì œê±°
  document.getElementById("loginSection").style.display = "none";

  // ğŸ“± ëª¨ë°”ì¼: ìŠ¤í”Œë˜ì‹œ 2ì´ˆ
  if (window.innerWidth <= 767) {
    const splash = document.getElementById("mobileSplash");
    splash.style.display = "flex";

    setTimeout(() => {
      splash.style.display = "none";
      document.getElementById("mainSection").style.display = "block";
    }, 2000);
  } 
  // ğŸ–¥ ë°ìŠ¤í¬íƒ‘: ì¦‰ì‹œ ì§„ì…
  else {
    document.getElementById("mainSection").style.display = "block";
  }

  document.getElementById("employeeName").textContent = user.name;
  document.body.classList.add("logged-in");
}
function tryAutoLogin() {
  const params = new URLSearchParams(window.location.search);
  const eid = params.get("eid");

  if (!eid) return;

  // inputì— ì‚¬ë²ˆ ì£¼ì…
  const input = document.getElementById("employeeId");
  if (input) input.value = eid;

  const user = employees.find(e => String(e.id) === String(eid));
  if (!user) {
    document.getElementById("loginError").textContent =
      "QR ì‚¬ë²ˆì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
    return;
  }

  // ğŸ”¥ ì—¬ê¸°ì„œ ë
  login();
}

/* ================= ì—¬í–‰ ì¼ì • ================= */
const travelSchedule = [
  {
    day: "DAY 1",
    date: "2026.03.11 (ìˆ˜)",
    title: "ì¸ì²œ â†’ íƒ€ì´ë² ì´ / ì‹œë‚´ í•˜ì´ë¼ì´íŠ¸",
    items: [
      { time:"08:00/9:00", icon:"âœˆï¸", title:"ì¸ì²œ êµ­ì œê³µí•­ ì¶œë°œ", desc:"OZ 711 / KE 2021" },
      { time:"12:30/13:30", icon:"ğŸœ", title:"ì¤‘ì‹ | ìš°ìœ¡ë©´", desc:"í˜„ì§€ ì¸ê¸° ì¤‘ì‹ë‹¹" },
      { time:"13:30/14:30", icon:"ğŸ›ï¸", title:"ë‹¨ìˆ˜ì´ ì˜›ê±°ë¦¬/í™ë§ˆì˜¤ì²­/ì§„ë¦¬ëŒ€í•™", desc:"í™ë§ˆì˜¤ì²­Â·ì˜›ê±°ë¦¬ ê´€ê´‘" },
      { time:"16:30/17:30", icon:"ğŸ¨", title:"í˜¸í…” ì²´í¬ì¸", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”[5ì„±ê¸‰]" },
      { time:"18:00/18:30", icon:"ğŸ½ï¸", title:"ì„ì‹ | íƒ€ì¹´ì˜¤ ìƒ¤ë¸Œìƒ¤ë¸Œ", desc:"ë¬´ì œí•œ ìƒ¤ë¸Œìƒ¤ë¸Œ" },
      { time:"19:00/19:30", icon:"ğŸŒƒ", title:"íƒ€ì´ë² ì´ 101 ì „ë§ëŒ€", desc:"ì•¼ê²½ ê´€ëŒ" },
      { time:"21:30", icon:"ğŸ¨", title:"í˜¸í…”ë³µê·€", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”[5ì„±ê¸‰]" }
    ]
  },
  {
    day: "DAY 2",
    date: "2026.03.12 (ëª©)",
    title: "ì„ íƒ ê´€ê´‘ / ë§Œì°¬",
    items: [
      { time:"08:30/9:00", icon:"ğŸšŒ", title:"ì„ íƒ ê´€ê´‘", desc:"ê°œì¸ ì„ íƒ ì¼ì •" },
      { time:"18:00", icon:"ğŸ‰", title:"ISC ë§Œì°¬", desc:"í•„ìˆ˜ ì°¸ì„" }
    ]
  },
  {
    day: "DAY 3",
    date: "2026.03.13 (ê¸ˆ)",
    title: "ê·¼êµ ê´€ê´‘",
    items: [
      { time:"10:00", icon:"ğŸ¨ğŸ½ï¸", title:"í˜¸í…” ì¡°ì‹ í›„ ì¶œë°œ", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”[5ì„±ê¸‰]" },
      { time:"11:00", icon:"ğŸŒŠ", title:"ì•¼ë¥˜ í•´ìƒê³µì›", desc:"ê¸°ì•”ê´´ì„ ê´€ê´‘" },
      { time:"12:30", icon:"ğŸ¦", title:"ì¤‘ì‹ : ì”¨í‘¸ë“œ", desc:"í˜„ì§€ í•´ì‚°ë¬¼ íŠ¹ì‹" },
      { time:"14:30", icon:"ğŸ®", title:"ìŠ¤í€ ì²œë“±ë‚ ë¦¬ê¸°", desc:"ì†Œì›ì²œë“± ë‚ ë¦¬ê¸°" },
      { time:"17:00", icon:"ğŸ®", title:"ì§€ìš°í€ ì•¼ê²½", desc:"í™ë“±ë§ˆì„" },
      { time:"20:00", icon:"ğŸŒŠ", title:"ì•¼ì‹œì¥ ë° ì„ì‹", desc:"ì•¼ì‹œì¥ ììœ ì‹ ë° ì‡¼í•‘" },
      { time:"21:30", icon:"ğŸ¨", title:"í˜¸í…”ë³µê·€", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”[5ì„±ê¸‰]" },
      { time:"ì „ì¼", icon:"ğŸ§­", title:"ììœ ì¼ì • ì„ íƒì‹œ", desc:"ì „ì²´ ê°œì¸ë¶€ë‹´(ì¤‘ì‹ë¹„ ì§€ê¸‰ X)" }
    ]
  },
  {
    day: "DAY 4",
    date: "2026.03.14 (í† )",
    title: "ê·€êµ­",
    items: [
      { time:"08:00/9:00", icon:"ğŸ¨", title:"í˜¸í…” ì²´í¬ì•„ì›ƒ", desc:"íƒ€ì´ë² ì´ ë©”ë¦¬ì–´íŠ¸ í˜¸í…”[5ì„±ê¸‰]" },
      { time:"11:40/12:25", icon:"âœˆï¸", title:"íƒ€ì´ë² ì´ ì¶œë°œ", desc:"OZ 712 / KE 2022" },
      { time:"15:25/15:50", icon:"ğŸ‡°ğŸ‡·", title:"ì¸ì²œ ë„ì°©", desc:"ISC in Taiwan" }
    ]
  }
];

/* ================= í˜ì´ì§€ ì—´ê¸° ================= */
function openPage(type, fromHistory = false) {

  if (!fromHistory) {
    pageHistory.push(type);
  }

  /* ================= í•µì‹¬ ìˆ˜ì • START ================= */

  const detail = document.getElementById("detailPage");

  // 1ï¸âƒ£ í•­ìƒ display ìƒíƒœ ë³´ì¥
  detail.style.display = "block";

  // 2ï¸âƒ£ ë‹¤ìŒ í”„ë ˆì„ì—ì„œ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
  requestAnimationFrame(() => {
    document.body.classList.add("detail-open");
  });

  /* ================= í•µì‹¬ ìˆ˜ì • END ================= */

  const t = document.getElementById("detailTitle");
  const c = document.getElementById("detailContent");

  c.innerHTML = `
  <div class="detail-content-wrap">
    ${travelSchedule.map(day => `
      <div class="day-card">
        <h3>${day.day} <span>${day.date}</span></h3>
        <p class="day-title">${day.title}</p>

        <div class="timeline">
          ${day.items.map(i => `
            <div class="schedule-item">
              <div class="timeline-dot"></div>
              <div class="schedule-card">
                <div class="schedule-time">${i.time}</div>
                <div class="schedule-body">
                  <div class="schedule-title">${i.icon} ${i.title}</div>
                  ${i.desc ? `<div class="schedule-desc">${i.desc}</div>` : ""}
                </div>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    `).join("")}
  </div>
`;


if (type === "flight") {
  const dep = currentUser.flight.departure;
  const ret = currentUser.flight.return;

  t.textContent = "âœˆï¸ í•­ê³µí¸ ì •ë³´";
 c.innerHTML = `
  <div class="detail-content-wrap">
    <div class="day-card">
      <h3>ì¶œêµ­í¸</h3>
      <div class="schedule-item">
        <div class="schedule-card">
          <div class="schedule-time">${dep.time}</div>
          <div class="schedule-body">
            <div class="schedule-title">âœˆï¸ ${dep.from} â†’ ${dep.to}</div>
            <div class="schedule-desc">${dep.airline} ${dep.flightNo}</div>
            <div class="schedule-desc">${dep.date}</div>
          </div>
        </div>
      </div>
    </div>

    <div class="day-card">
      <h3>ê·€êµ­í¸</h3>
      <div class="schedule-item">
        <div class="schedule-card">
          <div class="schedule-time">${ret.time}</div>
          <div class="schedule-body">
            <div class="schedule-title">ğŸ  ${ret.from} â†’ ${ret.to}</div>
            <div class="schedule-desc">${ret.airline} ${ret.flightNo}</div>
            <div class="schedule-desc">${ret.date}</div>
          </div>
        </div>
      </div>
    </div>
  `;
}
 

if (type === "myTour") {
  t.textContent = "ğŸ’ ë‚˜ì˜ ì„ íƒ ê´€ê´‘";
 c.innerHTML = `
  <div class="detail-content-wrap">
    <div class="mytour-wrap">
      ${renderMyTour()}
    </div>
  `;

  setTimeout(() => {
    const wrap = document.querySelector('.meal-check[data-tour="ììœ ì¼ì •"]');
    if (!wrap) return;
    syncMealStatusFromServer(currentUser.id, "ììœ ì¼ì •", wrap);
    }, 0);
}



if (type === "taiwan") {
  t.textContent = "ğŸ‡¹ğŸ‡¼ ëŒ€ë§Œì˜ ëª¨ë“  ê²ƒ";

 c.innerHTML = `
  <div class="detail-content-wrap">
    <div class="country-compare-grid">
      <!-- ëŒ€í•œë¯¼êµ­ -->
      <div class="country-card">
        <div class="country-header">
          <img src="assets/images/flag-kr.jpg" class="flag-img">
          <h3>ëŒ€í•œë¯¼êµ­</h3>
        </div>
        <div class="time-box">
          <span class="time-label">í˜„ì¬ ì‹œê°</span>
          <strong id="timeKR">--:--:--</strong>
        </div>
        <ul class="country-list">
          <li><span>ì‹œì°¨</span><strong>ê¸°ì¤€ êµ­ê°€</strong></li>
          <li><span>ì¸êµ¬</span><strong>ì•½ 5,100ë§Œ ëª…</strong></li>
          <li><span>ë©´ì </span><strong>ì•½ 100,210ã¢</strong></li>
          <li><span>GDP</span><strong>ì•½ 1.7ì¡° ë‹¬ëŸ¬</strong></li>
        </ul>
      </div>

      <!-- ëŒ€ë§Œ -->
      <div class="country-card">
        <div class="country-header">
          <img src="assets/images/flag-tw.jpg" class="flag-img">
          <h3>ëŒ€ë§Œ</h3>
        </div>
        <div class="time-box">
          <span class="time-label">í˜„ì¬ ì‹œê°</span>
          <strong id="timeTW">--:--:--</strong>
        </div>
        <ul class="country-list">
          <li><span>ì‹œì°¨</span><strong>í•œêµ­ë³´ë‹¤ 1ì‹œê°„ ëŠë¦¼</strong></li>
          <li><span>ì¸êµ¬</span><strong>ì•½ 2,300ë§Œ ëª…</strong></li>
          <li><span>ë©´ì </span><strong>ì•½ 36,197ã¢</strong></li>
          <li><span>GDP</span><strong>ì•½ 0.8ì¡° ë‹¬ëŸ¬</strong></li>
        </ul>
      </div>
    </div>

    <div class="exchange-row">
      í™˜ìœ¨: <strong>1 TWD â‰ˆ 42ì› ë‚´ì™¸</strong>
    </div>

    <p class="exchange-note">
      â€» í™˜ìœ¨ì€ ì‹¤ì‹œê°„ ë³€ë™ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    </p>

    <div class="day-card">
      <h3 class="section-title">ê¸°ë³¸ ì •ë³´</h3>
      <div class="info-card-grid">
        <div class="info-card">
          <h4>ğŸ‡¹ğŸ‡¼ êµ­ê¸°</h4>
          <p><strong>ì²­ì²œë°±ì¼ë§Œì§€í™ê¸°</strong><br>ê´‘ëª… Â· ììœ  Â· í¬ìƒ</p>
        </div>
        <div class="info-card">
          <h4>ğŸ—£ ì–¸ì–´</h4>
          <p>í‘œì¤€ ì¤‘êµ­ì–´ / ë²ˆì²´ í•œì</p>
        </div>
        <div class="info-card">
          <h4>â˜€ï¸ ê¸°í›„</h4>
          <p>3ì›” í‰ê·  18~25â„ƒ</p>
        </div>
      </div>
    </div>
  `;

  startWorldClock();
}
 

if (type === "dinner") {
  t.textContent = "ğŸ½ ë§Œì°¬ ì•ˆë‚´";
  c.innerHTML = `
    <div class="detail-content-wrap">
      <div class="card">ISC ê³µì‹ ë§Œì°¬</div>
    </div>
  `;
}

  
 if (type === "request") {
  t.textContent = "ğŸ“ ìš”ì²­ì‚¬í•­";
  c.innerHTML = `
    <div class="detail-content-wrap">
      <div class="card">
        <textarea id="requestInput" placeholder="ìš”ì²­ì‚¬í•­ ì…ë ¥"></textarea>
        <button class="primary-btn" onclick="submitRequest()">ì œì¶œ</button>
      </div>
    </div>
  `;
}
  /* ================= ë‹´ë‹¹ì 0000000ì €ë¶€ë¶„ ìˆ˜ì •ì§ì ‘í•˜ë©´ ë°”ë€œ ================= */
 if (type === "contact") {
  t.textContent = "ğŸ“ ê¸´ê¸‰ ì—°ë½ë§";

  c.innerHTML = `
  <div class="detail-content-wrap">
    <div class="day-card">
      <h3>ë¹„ìƒ ì—°ë½ë§</h3>

      <div class="timeline">
        <!-- ì¸ì¹´ë¸”ë£¨íˆ¬ì–´ -->
        <div class="schedule-item">
          <div class="timeline-dot"></div>
          <div class="schedule-card">
            <div class="schedule-body">
              <div class="schedule-title">ğŸ“ ì¸ì¹´ë¸”ë£¨íˆ¬ì–´</div>
              <div class="schedule-desc">
                ë‹´ë‹¹ì í™ê¸¸ë™ | 010-0000-0000
              </div>
            </div>
          </div>
        </div>

        <!-- ì¸ì¹´ ë§ˆì¼€íŒ…ë¶€ -->
        <div class="schedule-item">
          <div class="timeline-dot"></div>
          <div class="schedule-card">
            <div class="schedule-body">
              <div class="schedule-title">ğŸ“ ì¸ì¹´ ë§ˆì¼€íŒ…ë¶€</div>
              <div class="schedule-desc">
                ë‹´ë‹¹ì í˜„ë³´ë¼ê³¼ì¥ | 02-6214-0000
              </div>
            </div>
          </div>
        </div>

        <!-- í˜„ì§€ ê°€ì´ë“œ -->
        <div class="schedule-item">
          <div class="timeline-dot"></div>
          <div class="schedule-card">
            <div class="schedule-body">
              <div class="schedule-title">ğŸ“ í˜„ì§€ ê°€ì´ë“œ</div>
              <div class="schedule-desc">
                ë‹´ë‹¹ì Jason | +886-900-222-222
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  `;
}
}

async function syncMealStatusFromServer(userId, tour, wrap) {
  const url = `${MEAL_SHEET_URL}?mode=customerAdmin&id=${userId}`;
  const res = await fetch(url);
  const data = await res.json();

  const status = data.mealMap?.[tour]; // "APPROVE" | "CANCEL" | undefined

  if (status === "APPROVE") {
    setMealUI(wrap, "DONE", "ì„œë²„ ê¸°ì¤€");
  } else {
    setMealUI(wrap, "PENDING");
  }
}
/* ================= í™ˆìœ¼ë¡œ ================= */
function goHome() {
  // íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”
  pageHistory = [];

  // ìƒì„¸ ë‹«ê¸°
  document.body.classList.remove("detail-open");
}

    /* ================= ë’¤ë¡œê°€ê¸° ================= */
function goBack() {
  // í˜„ì¬ í˜ì´ì§€ ì œê±°
  pageHistory.pop();

  // ì´ì „ ê¸°ë¡ ì—†ìœ¼ë©´ í™ˆ
  if (pageHistory.length === 0) {
    goHome();
    return;
  }

  const prevType = pageHistory[pageHistory.length - 1];

  // historyì— ë‹¤ì‹œ ìŒ“ì§€ ì•Šê³  ë Œë”ë§Œ
  openPage(prevType, true);
}

  /* ================= ìš”ì²­ì‚¬í•­ ì „ì†¡ (ì—¬ê¸°ì— ì¶”ê°€) ================= */
function submitRequest() {
  const requestText = document.getElementById("requestInput").value.trim();

  if (!requestText) {
    alert("ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  if (!currentUser) {
    alert("ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  fetch(MEAL_SHEET_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify({
      type: "request",     // âœ… ì‹œíŠ¸1
      id: currentUser.id,
      name: currentUser.name,
      request: requestText,
      time: nowKSTString()
    })
  })
  .then(() => {
    alert("ìš”ì²­ì‚¬í•­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
    document.getElementById("requestInput").value = "";
  })
  .catch(err => {
    console.error(err);
    alert("ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  });
}

    function startWorldClock() {

  function updateTime() {
    const now = new Date();

    const kr = new Intl.DateTimeFormat("ko-KR", {
      timeZone: "Asia/Seoul",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    }).format(now);

    const tw = new Intl.DateTimeFormat("zh-TW", {
      timeZone: "Asia/Taipei",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    }).format(now);

    const krEl = document.getElementById("timeKR");
    const twEl = document.getElementById("timeTW");

    if (krEl && twEl) {
      krEl.textContent = kr;
      twEl.textContent = tw;
    }
  }

  updateTime();
  setInterval(updateTime, 1000);
}

</script>
<script>
(function () {
  let passed = false;

  function onScroll() {
    if (window.scrollY > 40 && !passed) {
      passed = true;
      document.body.classList.add("intro-passed");
    }
  }

  window.addEventListener("scroll", onScroll, { passive: true });
})();
</script>
  <script>
(function () {
  const ua = navigator.userAgent;

  if (/KAKAOTALK/i.test(ua)) {
    document.body.classList.add('ua-kakao');
  }
  if (/NAVER/i.test(ua)) {
    document.body.classList.add('ua-naver');
  }
  if (/iPhone|iPad|iPod/i.test(ua)) {
    document.body.classList.add('ua-ios');
  }
})();
</script>

</body>
</html>

ì ê¹ì„ì‹œ
